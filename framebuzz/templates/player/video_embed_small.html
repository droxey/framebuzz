{% load staticfiles socialaccount compress shorturl raven %}
<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/Article" ng-app="framebuzz" data-close-socket="">

<head itemscope itemtype="http://schema.org/Product">
    <title>FrameBuzz | {{ video.title }}</title>
    {% revcanonical video %}
    <meta itemprop="name" content="FrameBuzz: {{ video.title }}">
    <meta itemprop="description" content="I'm watching {{ video.title }}. Come talk about it with me on FrameBuzz!">
    <meta itemprop="image" content="{{ video.poster_image }}">
    <meta property="og:title" content="FrameBuzz: {{ video.title }}">
    <meta property="og:type" content="Video">
    <meta property="og:url" content="http://framebuzz.com{% url 'video-share' video.slug %}">
    <meta property="og:image" content="{{ video.poster_image }}">
    <meta property="og:description" content="{{ video.description }}">
    <meta property="og:site_name" content="FrameBuzz">
    <meta property="og:video" content="{{ video.mp4_url }}">
    <meta property="og:video:secure_url" content="{{ video.mp4_url }}">
    <meta property="og:video:type" content="text/html" />
    <style type="text/css">#container a.play-video { position: absolute; left: 47%; top: 43%; }</style>
</head>
<body>
    <div id="container" style="background-image: url('{{ video.default_thumbnail }}'); background-repeat: no-repeat;">
        <a class="play-video" href="{% url 'video-embed' video.slug %}" title="Launch pop-up player" target="fbz-{{ video.slug }}">
            <img src="{% static 'framebuzz/tumblr/img/play@2x.png' %}" height="47" width="47">
        </a>
    </div>
    {% compress js %}
        <script src="{% static 'framebuzz/player/app/lib/jquery/jquery-1.9.1.min.js' %}"></script>
        <script type="text/javascript">
            $(document).ready(function() {
                var width = window.frameElement.offsetWidth,
                    height = window.frameElement.offsetHeight,
                    fbzPlayer = $('iframe.fbzplayer'),
                    parentWindow = $(window.parent.document).find('body'),
                    windowObjectReference = null;

                $('#container').css({
                    'height': height,
                    'width': width,
                    'background-size': width + 'px ' + height + 'px'
                });

                // When the user chooses to play a video, save the url and then
                // pop up the player in a pop-up dialog.
                $(document).on('click', 'a.play-video', function() {
                    videoUrl = $(this).attr('href');
                    if (windowObjectReference == null || windowObjectReference.closed) {
                      windowObjectReference = window.open(videoUrl, 'fbz-{{ video.slug }}', 'width=700,height=430');
                    }
                    else {
                      windowObjectReference.focus();
                    }

                    return false;
                });
            });
        </script>
    {% endcompress %}
</body>
